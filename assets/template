{{- $name_length := 4}}
{{- $version_length := 4}}
{{- $type_length := 6}}
{{- $vulnerability_length := 13}}
{{- $severity_length := 8}}
{{- $location_length := 50}}
{{- range .Matches}}
{{- $temp_name_length := (len .Artifact.Name)}}
{{- $temp_version_length := (len .Artifact.Version)}}
{{- $temp_type_length := (len .Artifact.Type)}}
{{- $temp_vulnerability_length := (len .Vulnerability.ID)}}
{{- $temp_severity_length := (len .Vulnerability.Severity)}}
{{- $temp_location_length := (len .Artifact.Locations)}}
{{- if (lt $name_length $temp_name_length) }}
{{- $name_length = $temp_name_length}}
{{- end}}
{{- if (lt $version_length $temp_version_length) }}
{{- $version_length = $temp_version_length}}
{{- end}}
{{- if (lt $type_length $temp_type_length) }}
{{- $type_length = $temp_type_length}}
{{- end}}
{{- if (lt $vulnerability_length $temp_vulnerability_length) }}
{{- $vulnerability_length = $temp_vulnerability_length}}
{{- end}}
{{- if (lt $severity_length $temp_severity_length) }}
{{- $severity_length = $temp_severity_length}}
{{- end}}
{{- if (lt $location_length $temp_location_length) }}
{{- $location_length = $temp_location_length}}
{{- end}}
{{- end}}
{{- $name_length = add $name_length 2}}
{{- $pad_name := repeat (int $name_length) " "}}
{{- $version_length = add $version_length 2}}
{{- $pad_version := repeat (int $version_length) " "}}
{{- $type_length = add $type_length 2}}
{{- $pad_type := repeat (int $type_length) " "}}
{{- $vulnerability_length = add $vulnerability_length 2}}
{{- $pad_vulnerability := repeat (int $vulnerability_length) " "}}
{{- $severity_length = add $severity_length 2}}
{{- $pad_severity := repeat (int $severity_length) " "}}
{{- $location_length = add $location_length 2}}
{{- $pad_location := repeat (int $location_length) " "}}
{{cat "NAME" (substr 5 (int $name_length) $pad_name)}}{{cat "VERSION" (substr 6 (int $version_length) $pad_version)}}{{cat "TYPE" (substr 7 (int $type_length) $pad_type)}}{{cat "VULNERABILITY" (substr 14 (int $vulnerability_length) $pad_vulnerability)}}{{cat "SEVERITY" (substr 9 (int $severity_length) $pad_severity)}}{{cat "LOCATION" (substr 9 (int $location_length) $pad_location)}}
{{- range .Matches}}
{{cat .Artifact.Name (substr (int (add (len .Artifact.Name) 1)) (int $name_length) $pad_name)}}{{cat .Artifact.Version (substr (int (add (len .Artifact.Version) 1)) (int $version_length) $pad_version)}}{{cat .Artifact.Type (substr (int (add (len .Artifact.Type) 1)) (int $type_length) $pad_type)}}{{cat .Vulnerability.ID (substr (int (add (len .Vulnerability.ID) 1)) (int $vulnerability_length) $pad_vulnerability)}}{{cat .Vulnerability.Severity (substr (int (add (len .Vulnerability.Severity) 1)) (int $severity_length) $pad_severity)}}{{cat .Artifact.Locations (substr (int (add (len .Artifact.Locations) 1)) (int $location_length) $pad_location)}}
{{- end}}